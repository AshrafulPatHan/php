<!doctype html>
<html lang="bn">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Send JSON to API</title>
  <style>
    :root{--bg:#0f172a;--card:#0b1220;--accent:#6366f1;--muted:#94a3b8;--white:#eef2ff}
    body{font-family:system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial;background:linear-gradient(180deg,#071029 0%,#0b1220 100%);color:var(--white);min-height:100vh;display:flex;align-items:center;justify-content:center;padding:24px}
    .card{background:var(--card);padding:28px;border-radius:12px;box-shadow:0 8px 30px rgba(2,6,23,.6);width:100%;max-width:520px}
    h1{margin:0 0 12px;font-size:20px}
    label{display:block;margin-top:12px;font-size:14px;color:var(--muted)}
    input[type="text"], input[type="email"]{width:100%;padding:10px 12px;margin-top:6px;border-radius:8px;border:1px solid rgba(255,255,255,.06);background:transparent;color:var(--white);outline:none}
    .row{display:flex;gap:10px;margin-top:16px}
    button{background:var(--accent);border:none;color:white;padding:10px 14px;border-radius:10px;cursor:pointer;font-weight:600}
    pre{background:#021026;padding:12px;border-radius:8px;margin-top:16px;white-space:pre-wrap;color:#d1e7ff;overflow:auto}
    .muted{color:var(--muted);font-size:13px;margin-top:8px}
  </style>
</head>
<body>
  <div class="card">
    <h1>Send JSON to API</h1>

    <label for="name">Name</label>
    <input id="name" type="text" placeholder="Ashraful" value="Ashraful" />

    <label for="email">Email</label>
    <input id="email" type="email" placeholder="ashraful@mail.com" value="ashraful@mail.com" />

    <div class="row">
      <button id="sendBtn">Send (POST JSON)</button>
      <button id="sendGetBtn" style="background:#475569">Send (GET)</button>
    </div>

    <div class="muted">Response / debug:</div>
    <pre id="output">-- waiting --</pre>
  </div>

  <script>
    const apiUrl = "https://testphpcrud.free.nf/api.php";
    const out = document.getElementById('output');
    const sendBtn = document.getElementById('sendBtn');
    const sendGetBtn = document.getElementById('sendGetBtn');

    function show(msg){
      out.textContent = typeof msg === 'string' ? msg : JSON.stringify(msg, null, 2);
    }

    async function sendJSON(name, email){
      const payload = { name, email };

      try {
        show("Sending...\n\n" + JSON.stringify(payload, null, 2));

        const res = await fetch(apiUrl, {
          method: "POST",
          mode: "cors",              // 대부분 ক্ষেত্রে OK
          // credentials: 'include', // প্রয়োজনে আনকমেন্ট করো — কিন্তু সেক্ষেত্রে সার্ভার CORS-এ credentials অনুমোদন করতে হবে
          headers: {
            "Content-Type": "application/json",
            // "Accept": "application/json"
          },
          body: JSON.stringify(payload)
        });

        // সার্ভারের রেসপন্স ধরার চেষ্টা
        const text = await res.text(); // text() করে নিচ্ছি কারণ সার্ভার HTML বা plain text ফিরিয়েও দিতে পারে
        show("HTTP " + res.status + " " + res.statusText + "\n\n" + text);
      } catch (err) {
        show("Request failed:\n" + err.toString());
      }
    }

    async function sendGET(){
      try {
        show("Sending GET request...");
        // GET উদাহরণ (query params)
        const url = apiUrl + "?name=" + encodeURIComponent(document.getElementById('name').value)
                          + "&email=" + encodeURIComponent(document.getElementById('email').value);
        const res = await fetch(url, { method: "GET", mode: "cors" });
        const text = await res.text();
        show("HTTP " + res.status + " " + res.statusText + "\n\n" + text);
      } catch (err){
        show("GET failed:\n" + err.toString());
      }
    }

    sendBtn.addEventListener('click', () => {
      const n = document.getElementById('name').value.trim();
      const e = document.getElementById('email').value.trim();
      if(!n || !e){ show("Please provide name and email."); return; }
      sendJSON(n, e);
    });

    sendGetBtn.addEventListener('click', () => sendGET());
  </script>
</body>
</html>
